# if-else判断冗余解决思路

## 前言

`if-else` 用于判断，使用场景广泛。但是当判断条件多样复杂时，往往代码量会非常大，代码执行效率与可读性都大打折扣。如下所示：

![if的使用](https://s1.ax1x.com/2023/02/15/pS7BsoD.png)

多重判断，判断内再嵌套判断，不仅运行效率慢，代码可读性也差，后期维护成本提高。著名的R星GTA5运行时间缓慢就是因为几千条if判断。下面列出几条优化小方案。

## 方案

### 短路运算

短路运算又分为短路与和短路或运算，其特点是当符合条件后下面的代码不再继续执行。短路运算可以分为两种逻辑运算符，分别是`&&`（与）和 `||`（或）。

- 短路与

  短路与写法为 `&&` ，其特点是一假则假。当前面的代码是假时，后续的代码不会再执行。如果不短路，则继续执行，且返回的是最后的值。

  ```js
  password && phone && axios.get()
  ```

  上方代码为当用户都输入手机号与密码后才会执行发请求的操作，可读性高，代码简洁。

- 短路或

  短路或写法为 `||` ，其特点是一真则真。当前面的代码是真时，后续的代码不会再执行。如果不短路，则继续执行，且返回的是最后的值。

  ```js
  checkVal || radioVal || console.log('请勾选任意选项')
  ```

  上方代码为当用户未勾选时给予提示。

### 三元表达式

三元表达式的语法如下：

```js
判断 ? 判断为真所执行的步骤 : 判断为假所执行的步骤
```

三元表达式最大的优点是简单易看，可读性高，一眼就能看出其要执行的操作但是不建议多层嵌套，多层嵌套可读性比 `if-else if-else` 更冗余繁琐。

```js
flag && timer ? fn() : timers()
```

三元可搭配短路运算使用，通过函数的调用来执行需要的步骤。

### switch

`switch` 也是一个经典的判断条件代码，其语法如下所示：

```js
swtich(n) {   
     case 常量1 :
       要执行的语句;
       break;
     case 常量2 :
       要执行的语句;
       break;
     case 常量3 :
       要执行的语句;
        break;
     default:
       要执行的语句;
       break;
}
```

`case` 后面一般接一个常量，或者接一个判断表达式，符合要求时则执行对应的语句，直到遇到`break` 或  `return` 。下图为使用 `case` 配合函数，每个功能都独立出来，可读性高，也利于维护。

![case运用](https://s1.ax1x.com/2023/02/15/pS7bEPH.png)

注意：并不是 `switch` 就一定比 `if` 好用，还是要注意使用的场合，如格式化时间时判断当前分秒是否个位，非个位数则补0。

`if` 语句为：

```js
if(num > 10) { return num } else { return '0' + num }
```

`switch` 语句为：

```js
switch(num) {
    case 0:
    case 1:
    case 2:
    case 3:
    case 4:
    case 5:
    case 6:
    case 7:
    case 8:
    case 9:
        return '0' + num;
    default:
        return num;
}
```

### 模块独立

冗余的代码一般把所有模块都堆积在一起，如下所示：

```js
if(num > 0) {
    // ...
} else if (num < 0) {
    // ...
    if (res > num) {
        // ...
    } else {}
} else if (isNaN(num)) {
    // ...
} else {
    ...
}
```

可以把整体代码分为4个模块，每一个模块各司其职，如下所示：

```js
const fn = {
  x(num) { /* ... */ },
  y(num) { /* ... */ },
  z(num) { /* ... */ }
}

function demo (num) {
  return fn[action](num)
}
```

每个 `else if` 中的逻辑都被改写为一个独立的函数。