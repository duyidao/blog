import{_ as s,o as a,c as l,S as o}from"./chunks/framework.e036d9b7.js";const A=JSON.parse('{"title":"前端下载后端传输的文件","description":"","frontmatter":{},"headers":[],"relativePath":"learn/学而时习之/前端功能操作模块/前端下载后端传输的文件.md","filePath":"learn/学而时习之/前端功能操作模块/前端下载后端传输的文件.md","lastUpdated":null}'),n={name:"learn/学而时习之/前端功能操作模块/前端下载后端传输的文件.md"},p=o(`<h1 id="前端下载后端传输的文件" tabindex="-1">前端下载后端传输的文件 <a class="header-anchor" href="#前端下载后端传输的文件" aria-label="Permalink to &quot;前端下载后端传输的文件&quot;">​</a></h1><p>下载文件方案分为以下几种：</p><ol><li><p>直接打开下载地址</p><p>无法命名，只适用于 <code>get</code> 直接返回 <code>blob</code> 的接口。如果下载接口需要携带 <code>token</code> 则无法实现。</p></li><li><p>利用 <code>a</code> 标签的 \`\`download\` 属性</p><p>比较合适的方案</p></li><li><p>第三方库 <code>file-saver</code></p></li></ol><h2 id="直接打开" tabindex="-1">直接打开 <a class="header-anchor" href="#直接打开" aria-label="Permalink to &quot;直接打开&quot;">​</a></h2><p>通过 <code>window.open()</code> 直接打开下载。</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">downloadFn</span><span style="color:#A6ACCD;">() </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">open</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">http://xxx</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>缺点：</p><ol><li>无法更改名称</li><li>无法做 <code>token</code> 校验</li></ol><h2 id="a标签下载" tabindex="-1">a标签下载 <a class="header-anchor" href="#a标签下载" aria-label="Permalink to &quot;a标签下载&quot;">​</a></h2><h3 id="前置知识" tabindex="-1">前置知识 <a class="header-anchor" href="#前置知识" aria-label="Permalink to &quot;前置知识&quot;">​</a></h3><h4 id="createobjecturl" tabindex="-1">createObjectURL <a class="header-anchor" href="#createobjecturl" aria-label="Permalink to &quot;createObjectURL&quot;">​</a></h4><p><code>createObjectURL</code> 是一个用于创建指定对象的 URL 的方法。它可以将 Blob、File 或 MediaSource 对象转换为一个可供使用的 URL。</p><p>以下是 <code>createObjectURL</code> 的使用示例：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> fileInput </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getElementById</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fileInput</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> imageElement </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getElementById</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">imageElement</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">fileInput</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addEventListener</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">change</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">event</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">selectedFile</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">target</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">files</span><span style="color:#F07178;">[</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 创建 URL</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fileURL</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">URL</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createObjectURL</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">selectedFile</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 将 URL 赋值给图片元素的 src 属性</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">imageElement</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">src</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fileURL</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><p>在这个例子中，我们假设有一个 <code>&lt;input type=&quot;file&quot;&gt;</code> 元素用于选择文件，并且有一个 id 为 “imageElement” 的图片元素用于显示选择的图像。</p><p>在 <code>change</code> 事件处理程序中，我们使用 <code>event.target.files[0]</code> 获取用户选择的文件对象。</p><p>然后，我们使用 <code>createObjectURL</code> 方法将文件对象转换为一个 URL。这个 URL 表示了该文件的临时 URL，可以立即使用。</p><p>最后，我们将这个 URL 赋值给图片元素的 <code>src</code> 属性。这样，浏览器会自动加载该 URL 对应的文件，并将其显示在图片元素中。</p><blockquote><p>注意</p><p><code>createObjectURL</code> 创建的 URL 是临时的，在浏览器会话结束或使用 <code>revokeObjectURL</code> 方法释放之前，这个 URL 是有效的。为了避免资源浪费，建议在使用完 URL 后调用 <code>revokeObjectURL</code> 方法来释放与之相关的内存资源。例如：</p></blockquote><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">URL</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">revokeObjectURL</span><span style="color:#A6ACCD;">(fileURL)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><p>这样可以确保及时释放资源，避免内存泄漏。</p><p>总而言之，<code>createObjectURL</code> 是一个方便的方法，可以将 Blob、File 或 MediaSource 对象转换为可供使用的 URL。它在一些场景中非常有用，例如预览图像、播放音频/视频等。</p><h4 id="mssaveblob" tabindex="-1">msSaveBlob <a class="header-anchor" href="#mssaveblob" aria-label="Permalink to &quot;msSaveBlob&quot;">​</a></h4><p><code>msSaveBlob</code> 是用于将 Blob 对象保存为文件的 Microsoft 特定方法。它可用于 Internet Explorer 和 Microsoft Edge 浏览器中，并提供文件保存功能。</p><p>以下是使用 <code>msSaveBlob</code> 方法保存 Blob 对象的示例：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> blob </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Blob</span><span style="color:#A6ACCD;">([</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Hello, World!</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">type</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">text/plain</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">typeof</span><span style="color:#A6ACCD;"> navigator</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">msSaveBlob </span><span style="color:#89DDFF;">===</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">function</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">navigator</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">msSaveBlob</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">blob</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">example.txt</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">This browser does not support msSaveBlob.</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>在这个例子中，我们首先创建了一个包含文本数据的 Blob 对象。然后，我们通过检查 <code>navigator.msSaveBlob</code> 函数是否存在来确保当前浏览器是支持这个方法的。</p><p>如果当前浏览器支持 <code>msSaveBlob</code>，我们可以使用它来保存 Blob。<code>msSaveBlob</code> 方法接受两个参数：要保存的 Blob 对象和保存的文件名。在这个示例中，我们将 Blob 对象保存为名为 “example.txt” 的文本文件。</p><p>如果浏览器不支持 <code>msSaveBlob</code> 方法，我们只是向控制台输出一条提示信息。</p><blockquote><p>注意</p><p><code>msSaveBlob</code> 是微软特定的方法，仅适用于 Internet Explorer 和 Microsoft Edge 浏览器。对于其他现代浏览器，通常可以使用更通用的方法，如使用 FileSaver.js 库或通过创建链接来触发文件下载。</p></blockquote><p>综上所述，通过 <code>msSaveBlob</code> 方法可以在 Internet Explorer 和 Microsoft Edge 浏览器中将 Blob 对象保存为文件。但要注意它的局限性和该方法在其他浏览器中的不兼容性。</p><h4 id="download" tabindex="-1">download <a class="header-anchor" href="#download" aria-label="Permalink to &quot;download&quot;">​</a></h4><p><code>download</code> 是一个HTML5属性，用于指定一个链接（通常是 <code>&lt;a&gt;</code> 元素）的目标资源应该被下载而不是在浏览器中打开。</p><p>使用 <code>download</code> 属性，可以将链接的目标资源（如文件）提供给用户下载，而不会自动打开或在浏览器中显示。当用户点击链接时，浏览器将提供下载选项，用户可以选择保存文件到本地。</p><p>以下是一个使用 <code>download</code> 属性的示例：</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">a</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">href</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">path/to/file.pdf</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">download</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">Download PDF</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">a</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p>在这个例子中，我们创建了一个指向 “path/to/file.pdf” 的链接，并将 <code>download</code> 属性添加到 <code>&lt;a&gt;</code> 元素中。这表示资源应该被下载而不是打开。</p><p>当用户点击该链接时，浏览器将弹出一个文件保存对话框，用户可以选择保存文件到本地。</p><p>你还可以通过将 <code>download</code> 属性值设置为指定的文件名，来指定下载文件的名称，而不是使用默认的文件名。例如：</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">a</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">href</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">path/to/file.pdf</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">download</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">myFile.pdf</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">Download PDF</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">a</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p>在这个示例中，用户保存的文件将命名为 “myFile.pdf”。</p><blockquote><p>注意</p><ol><li><code>download</code> 属性对于所有浏览器并非都有完全的支持。但绝大多数现代浏览器都支持这个属性。</li><li>目标资源必须是同源的（即位于相同域名和协议下），否则 <code>download</code> 属性可能无效。</li></ol></blockquote><p>综上所述，<code>download</code> 属性是用于在 HTML 中提供文件下载的简单且常用的方式。它可以使用户方便地下载特定资源，并提供自定义的文件名选项。</p><h3 id="流程梳理" tabindex="-1">流程梳理 <a class="header-anchor" href="#流程梳理" aria-label="Permalink to &quot;流程梳理&quot;">​</a></h3><p>首先按 <code>blob</code> 格式请求接口接收二进制文件，然后判断是否有 <code>msSaveBlob</code> 。</p><p>有msSaveBlob：用 <code>msSaveBlob</code> 下载。</p><p>无msSaveBlob，按照以下步骤实现：</p><ul><li><code>createObjectURL</code> 创建文件本地 <code>url</code></li><li>创建 <code>a</code> 标签</li><li>创建的 <code>url</code> 给到 <code>a</code> 标签的 <code>href</code></li><li>设置 <code>download</code> （即文件名）</li><li>模拟点击下载</li><li>下载完毕，销毁 <code>a</code> 标签</li></ul><h3 id="示例图" tabindex="-1">示例图 <a class="header-anchor" href="#示例图" aria-label="Permalink to &quot;示例图&quot;">​</a></h3><p><a href="https://imgse.com/i/pCbAAfA" target="_blank" rel="noreferrer"><img src="https://s1.ax1x.com/2023/07/21/pCbAAfA.png" alt="pCbAAfA.png"></a></p><h3 id="代码实操" tabindex="-1">代码实操 <a class="header-anchor" href="#代码实操" aria-label="Permalink to &quot;代码实操&quot;">​</a></h3><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 按blob请求接口</span></span>
<span class="line"><span style="color:#A6ACCD;">axios</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">http://xxx</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">responseType</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">blob</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#A6ACCD;">(</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">navigator</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">msSaveBlob</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// IE浏览器</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">navigator</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">msSaveBlob</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">data</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> type</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">application/vnd.openxmlformats-officedocument.presentationml.presentation</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">},</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">download.ppt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// 非IE</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">blobURL</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">URL</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createObjectURL</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">data</span><span style="color:#F07178;">) </span><span style="color:#676E95;font-style:italic;">// 创建blob本地url</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">link</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createElement</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">a</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">) </span><span style="color:#676E95;font-style:italic;">// 创建标签</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">link</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">href</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">blobURL</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// 设置href</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">link</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">download</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">download.ppt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// 设置下载的文件名</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">link</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">style</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">display</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">none</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// 把他隐藏</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">link</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">click</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">link</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">remove</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">URL</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">revokeObjectURL</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">blobURL</span><span style="color:#F07178;">) </span><span style="color:#676E95;font-style:italic;">// 销毁临时地址</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h2 id="file-saver" tabindex="-1">file-saver <a class="header-anchor" href="#file-saver" aria-label="Permalink to &quot;file-saver&quot;">​</a></h2><ul><li><p>下载</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">yarn add file-saver</span></span></code></pre></div></li><li><p>引入 <code>saver</code></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">saveAs</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file-saver</span><span style="color:#89DDFF;">&#39;</span></span></code></pre></div></li><li><p>使用</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">axios</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">http://xxx</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">responseType</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">blob</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#A6ACCD;">(</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">saveAs</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">data</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">download.ppt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">) </span><span style="color:#676E95;font-style:italic;">// 路径，名称</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div></li></ul><h2 id="拓展-如何预览" tabindex="-1">拓展：如何预览 <a class="header-anchor" href="#拓展-如何预览" aria-label="Permalink to &quot;拓展：如何预览&quot;">​</a></h2><p>下载完文件后想要展示预览该如何实现？</p><h3 id="思路分析" tabindex="-1">思路分析 <a class="header-anchor" href="#思路分析" aria-label="Permalink to &quot;思路分析&quot;">​</a></h3><p>预览无论是图片，还是 <code>excel</code>、<code>word</code> ，都需要一个地址 <code>url</code> ，后端返回的在线地址可以使用。</p><p><code>url</code> 除了线上地址，还能使用 <code>base64</code> 地址。因此接收到 <code>blob</code> 地址后把它转为 <code>base64</code> 即可。</p><p>转换方法可以用到 <code>fileReader</code> 方法转换成任意我们想要的格式。</p>`,60),e=[p];function t(c,r,y,F,D,i){return a(),l("div",null,e)}const C=s(n,[["render",t]]);export{A as __pageData,C as default};
